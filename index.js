const CLICKED_BUTTON_COLOUR = "rgb(208, 208, 215)"
const NOT_CLICKED_BUTTON_COLOUR = "rgb(233, 233, 237)"


L.Polyline = L.Polyline.include({
  getDistance: function() {
    var mDistanse = 0,
    length = this._latlngs.length;
    for (var i = 1; i < length; i++) {
      mDistanse += this._latlngs[i].distanceTo(this._latlngs[i - 1]);
    }
    return mDistanse / 1000;
  }
});

var map = L.map('map').setView([49.7941, 24.0577], 13);

L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
  maxZoom: 19,
  attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
}).addTo(map);

// L.marker([49.78441, 24.05843]).addTo(map)
//   .bindPopup('Хатка.')
//   .openPopup();

var roads = {
  "start_finish-dobriachynskyi_vyyizd": [
    [50.40164, 24.23933],
    [50.40148, 24.23994],
    [50.40173, 24.24015],
    [50.40195, 24.23946],
    [50.40217, 24.23962],
    [50.40266, 24.23774],
    [50.40251, 24.23761],
    [50.40305, 24.2356],
    [50.4052, 24.23699],
    [50.40627, 24.23692],
    [50.40737, 24.23559],
  ],
  "dobriachynskyi_vyyizd-povorot_na_boriatyn": [
    [50.40737, 24.23559],
    [50.40939, 24.23553],
    [50.41025, 24.23614],
    [50.41118, 24.23766],
    [50.4123, 24.23828],
    [50.41361, 24.23951],
    [50.4173, 24.2396],
    [50.42026, 24.24056],
  ],
  "povorot_na_boriatyn-boriatynskyi_vyyizd": [
    [50.42026, 24.24056], // поворот на Борятин в Добрячині
    [50.4218, 24.2311],
    [50.42229, 24.2267],
    [50.42359, 24.22192],
    [50.4248, 24.2146],
    [50.4249, 24.2119],
    [50.4246, 24.20678],
    [50.42465, 24.20186],
    [50.42603, 24.1912],
    [50.42632, 24.18462],
    [50.42604, 24.18428],
    [50.42653, 24.18162], // виїзд на Р15 в Борятині біля цвинтаря
  ],
  "boriatynskyi_vyyizd-savchynske_perehrestia": [
    [50.42653, 24.18162], // виїзд на Р15 в Борятині біля цвинтаря
    [50.45038, 24.18842],
    [50.45149, 24.18853],
    [50.45226, 24.1884],
    [50.47359, 24.18476],
    [50.47474, 24.18446], // поворот біля Савчина
  ],
  "savchynske_perehrestia-povorot_na_savhyn": [
    [50.47474, 24.18446], // поворот біля Савчина
    [50.4749, 24.191],
    [50.4749, 24.1952],
    [50.475, 24.1987],
    [50.475, 24.2013],
    [50.4747, 24.2058],
    [50.4737, 24.2159],
    [50.4721, 24.2264],
    [50.4715, 24.2339],
    [50.4699, 24.2463],
    [50.4687, 24.25315],
    [50.46902, 24.25468],
    [50.4686, 24.257], // поворот на Савчин у Жвирці
  ],
  "povorot_na_savhyn-povorot_na_zavyshen": [
    [50.4686, 24.257], // поворот на Савчин у Жвирці
    [50.4646, 24.2559],
    [50.4628, 24.2552],
    [50.461, 24.2543],
    [50.4596, 24.2548],
    [50.4584, 24.2551],
    [50.45705, 24.25505],
    [50.45589, 24.25478],
    [50.45561, 24.25456],
    [50.45535, 24.25423],
    [50.45438, 24.25278],
    [50.45369, 24.25232],
    [50.44744, 24.24933], // поворот на Завишень з Сокальської траси
  ],
  "povorot_na_zavyshen-perehrestia_v_zavyshni": [
    [50.44744, 24.24933], // поворот на Завишень з Сокальської траси
    [50.44592, 24.26073],
    [50.44552, 24.26245], // перехрестя в Завишні
  ],
  "stezhka_pid_buhom": [
    [50.44552, 24.26245], // перехрестя в Завишні
    [50.44425, 24.26123],
    [50.44353, 24.26029],
    [50.44316, 24.26054],
    [50.44307, 24.26096],
    [50.44269, 24.26147],
    [50.44231, 24.26158],
    [50.43954, 24.2617],
    [50.43755, 24.26167],
    [50.43624, 24.26148],
    [50.43495, 24.26092],
    [50.43479, 24.26065],
    [50.43446, 24.26066],
    [50.4341, 24.26077],
    [50.43386, 24.26087],
    [50.43363, 24.26104],
    [50.43323, 24.26122],
    [50.43309, 24.26122],
    [50.43145, 24.26111],
    [50.43093, 24.26067],
    [50.43051, 24.26045],
    [50.43027, 24.26048],
    [50.43001, 24.26083],
    [50.42885, 24.26119],
    [50.42716, 24.26076],
    [50.42693, 24.26021],
    [50.42648, 24.25977],
    [50.42564, 24.2594],
    [50.4235, 24.25901],
    [50.42228, 24.25867],
    [50.42144, 24.25865],
    [50.42068, 24.25827],
    [50.41933, 24.25801],
    [50.41814, 24.25704],
    [50.41714, 24.25662],
    [50.41597, 24.25657],
    [50.41444, 24.25505],
    [50.41344, 24.25431],
    [50.41274, 24.25385],
    [50.41157, 24.25351],
    [50.41119, 24.25342],
    [50.40952, 24.25404],
    [50.40898, 24.25402],
    [50.40856, 24.25393],
    [50.40834, 24.25397],
    [50.40729, 24.25492],
    [50.40697, 24.25508],
    [50.40653, 24.2551],
    [50.40534, 24.25562],
    [50.40481, 24.25504],
    [50.40462, 24.25495],
    [50.40427, 24.25512],
    [50.40384, 24.25511],
    [50.40378, 24.25488],
    [50.40362, 24.25483], // виїзд на вулицю Мазепи зі стежки під Бугом
  ],
  "vyizd_zi_stezhky_pid_buhom-start_finish": [
    [50.40362, 24.25483], // виїзд на вулицю Мазепи зі стежки під Бугом
    [50.40216, 24.24775],
    [50.40203, 24.24752],
    [50.40189, 24.24743],
    [50.40152, 24.2473],
    [50.40087, 24.24656],
    [50.40135, 24.2454],
    [50.40088, 24.24316],
    [50.40107, 24.24249],
    [50.40171, 24.24019],
    [50.40148, 24.23994],
    [50.40164, 24.23933],
  ],
  "perehrestia_v_zavyshni-sokalskyi_mish_livyi_bereh": [
    [50.44552, 24.26245], // перехрестя в Завишні
    [50.44599, 24.26323],
    [50.44622, 24.26343],
    [50.44699, 24.26403],
    [50.4476, 24.26428],
    [50.44795, 24.26449],
    [50.44854, 24.265],
    [50.44994, 24.26584],
    [50.45037, 24.26592],
    [50.45114, 24.26592],
    [50.45183, 24.26574],
    [50.45291, 24.2653],
    [50.45349, 24.26369],
    [50.45363, 24.26263],
    [50.4561, 24.26333],
    [50.45958, 24.26444],
    [50.46073, 24.26486],
    [50.46155, 24.27212],
    [50.46291, 24.27158],
    [50.46436, 24.27093],
    [50.46555, 24.27032],
    [50.46632, 24.27005], // перехрестя у Жвирці перед мостом
  ],
  "mist_v_sokali": [
    [50.46632, 24.27005], // перехрестя у Жвирці перед мостом
    [50.46726, 24.27352],
    [50.4679, 24.27583], // перехрестя на Богдана в Сокалі
  ],
  "sokal_bohdana-sokal_ukrauinska": [
    [50.4679, 24.27583], // перехрестя на Богдана в Сокалі
    [50.46852, 24.27565],
    [50.46921, 24.27548],
    [50.4694, 24.27563],
    [50.46987, 24.27644],
    [50.47019, 24.27672],
    [50.47072, 24.27694],
    [50.471, 24.27694],
    [50.47252, 24.27673], // перехрестя Шептицького-Українська в Сокалі
  ],
  "sokal_ukrayinska-sokal_centre": [
    [50.47252, 24.27673], // перехрестя Шептицького-Українська в Сокалі
    [50.47284, 24.2767],
    [50.47403, 24.27692],
    [50.4757, 24.27732],
    [50.47618, 24.27733],
    [50.47841, 24.27723],
    [50.47945, 24.27727], // Сокаль центр біля Шевченка
  ],
  "sokal_centre-ilkovychi": [
    [50.47945, 24.27727], // Сокаль центр біля Шевченка
    [50.48097, 24.27732],
    [50.48179, 24.27723],
    [50.48261, 24.27709],
    [50.4851, 24.27649],
    [50.48674, 24.27682],
    [50.48773, 24.27694],
    [50.48822, 24.2772],
    [50.4891, 24.2784],
    [50.48952, 24.2786],
    [50.4902, 24.27879],
    [50.49128, 24.27944],
    [50.49232, 24.27992],
    [50.49652, 24.2825],
    [50.49947, 24.28434],
    [50.50069, 24.28522],
    [50.50174, 24.28612],
    [50.50292, 24.28696],
    [50.50434, 24.28839],
    [50.50586, 24.29013],
    [50.50831, 24.29308],
    [50.51093, 24.29634],
    [50.51339, 24.29947],
    [50.5178, 24.3035],
    [50.52017, 24.30574],
    [50.52397, 24.30939],
    [50.52347, 24.31475],
    [50.52358, 24.31558], // Поворот на Свитязів в Ільковичах
  ],
  "ilkovychi-skomorohy": [
    [50.52358, 24.31558], // Поворот на Свитязів в Ільковичах
    [50.5242, 24.31681],
    [50.5242, 24.31741],
    [50.52401, 24.31939],
    [50.52407, 24.32016],
    [50.52451, 24.32125],
    [50.52502, 24.32157],
    [50.52631, 24.32185],
    [50.52674, 24.3222],
    [50.52791, 24.32398],
    [50.5284, 24.32438],
    [50.53011, 24.32494],
    [50.53189, 24.32546],
    [50.53274, 24.32545],
    [50.53563, 24.32498],
    [50.53601, 24.32505],
    [50.53808, 24.32568], // Перехрестя в Скоморохах
  ],
  "skomorohy-trudoliubivka_zupynka": [
    [50.53808, 24.32568], // Перехрестя в Скоморохах
    [50.53838, 24.32407],
    [50.53842, 24.32204],
    [50.5383, 24.3209],
    [50.53809, 24.3197],
    [50.53842, 24.31785],
    [50.53837, 24.31757],
    [50.5381, 24.31685],
    [50.53811, 24.31633],
    [50.53859, 24.31543],
    [50.53894, 24.31472],
    [50.53929, 24.31372],
    [50.53931, 24.31311],
    [50.53937, 24.31293],
    [50.53955, 24.31259],
    [50.53958, 24.31172],
    [50.53973, 24.31122],
    [50.54027, 24.31063],
    [50.54067, 24.31028],
    [50.54089, 24.30985],
    [50.54099, 24.30937],
    [50.541, 24.30832],
    [50.54075, 24.30554],
    [50.54051, 24.30479],
    [50.53337, 24.2876],
    [50.53208, 24.28531],
    [50.53053, 24.28235],
    [50.52858, 24.2784],
    [50.52801, 24.27724],
    [50.52779, 24.2766],
    [50.52744, 24.27611],
    [50.52719, 24.27556],
    [50.5267, 24.27438],
    [50.52607, 24.27369],
    [50.52506, 24.27214],
    [50.5241, 24.27022],
    [50.52388, 24.26972],
    [50.52311, 24.26842],
    [50.52268, 24.26741],
    [50.52195, 24.26645],
    [50.52163, 24.2661],
    [50.52111, 24.26584],
    [50.52036, 24.26454],
    [50.51999, 24.26298],
    [50.51839, 24.26149],
    [50.51702, 24.26015],
    [50.51675, 24.25974],
    [50.51622, 24.259],
    [50.51569, 24.25861],
    [50.51518, 24.25842],
    [50.5146, 24.25839],
    [50.51422, 24.25804],
    [50.51389, 24.25733],
    [50.51376, 24.25677],
    [50.51411, 24.25453],
    [50.51429, 24.25183],
    [50.51418, 24.25141],
    [50.51396, 24.25112],
    [50.51238, 24.25071],
    [50.51222, 24.25054],
    [50.51182, 24.24957],
    [50.51126, 24.24888],
    [50.51097, 24.24865],
    [50.51036, 24.24849],
    [50.5097, 24.24855],
    [50.50912, 24.24841],
    [50.50856, 24.24824],
    [50.50784, 24.24791], // Перехрестя біля залізничної зупинки Трудолюбівка
  ],
  "trudoliubivka_zupynka-perehrestia_v_zabuzhzhi": [
    [50.50784, 24.24791], // Перехрестя біля залізничної зупинки Трудолюбівка
    [50.50598, 24.24816],
    [50.50409, 24.24821],
    [50.50326, 24.24842],
    [50.50205, 24.24932],
    [50.5018, 24.24948],
    [50.5, 24.24992],
    [50.49953, 24.25013],
    [50.49725, 24.25194],
    [50.49635, 24.25236],
    [50.49401, 24.25325],
    [50.48911, 24.25664],
    [50.48711, 24.25689], // Поворот на Опільсько в Забужжі
  ],
  "perehrestia_v_zabuzhzhi-povorot_na_boyanychi": [
    [50.48711, 24.25689], // Поворот на Опільсько в Забужжі
    [50.48775, 24.25241],
    [50.48986, 24.23246],
    [50.49014, 24.2307],
    [50.49064, 24.22877],
    [50.49126, 24.22491],
    [50.49264, 24.21485],
    [50.49291, 24.21377],
    [50.49369, 24.2121],
    [50.49435, 24.21042],
    [50.49444, 24.20981],
    [50.49422, 24.20725],
    [50.49334, 24.20458],
    [50.49259, 24.20187],
    [50.49177, 24.19818],
    [50.48903, 24.17768], // Перехрестя біля Боянич
  ],
  "boriatynskyi_vyyizd_nyzhche-boriatyn_povorot_na_rudku": [
    [50.4216, 24.17972], // Виїзд на Р15 в Борятині з вулиці Палюшинського
    [50.42162, 24.18238],
    [50.4216, 24.18285],
    [50.42151, 24.18353],
    [50.42089, 24.18632],
    [50.42088, 24.18658],
    [50.42091, 24.18755],
    [50.42088, 24.18787],
    [50.42056, 24.19045],
    [50.42017, 24.19497],
    [50.42018, 24.19523],
    [50.42025, 24.19577],
    [50.42045, 24.1967], // Поворот на Рудку в Борятині
  ],
  "boriatyn_povorot_na_rudku-harazhnyi_kooperatyv_5": [
    [50.42045, 24.1967], // Поворот на Рудку в Борятині
    [50.41739, 24.20002],
    [50.41406, 24.203],
    [50.41115, 24.20619],
    [50.40882, 24.2086],
    [50.40842, 24.20963],
    [50.40597, 24.21307],
    [50.40535, 24.21357],
    [50.40513, 24.21417],
    [50.4042, 24.21538],
    [50.40345, 24.21659],
    [50.40355, 24.21718],
    [50.40375, 24.21764],
    [50.40402, 24.21813],
    [50.40541, 24.22168],
    [50.4056, 24.222],
    [50.40579, 24.22215],
    [50.40583, 24.2224],
    [50.4059, 24.2285],
    [50.40557, 24.22858],
    [50.40555, 24.23046],
    [50.40558, 24.23122],
    [50.40564, 24.23188],
    [50.4057, 24.23288],
    [50.40568, 24.23344],
    [50.40579, 24.23575], // Поворот на гаражний кооператив №5
  ],
  "harazhnyi_kooperatyv_5-start_finish": [
    [50.40579, 24.23575], // Поворот на гаражний кооператив №5
    [50.4055, 24.2362],
    [50.40512, 24.23613],
    [50.40445, 24.23656],
    [50.4043, 24.23649],
    [50.40305, 24.2356],
    [50.40251, 24.23761],
    [50.40266, 24.23774],
    [50.40217, 24.23962],
    [50.40195, 24.23946],
    [50.40173, 24.24015],
    [50.40148, 24.23994],
    [50.40164, 24.23933],
  ],
  "start_finish-pamyatnyk_hrushevskomu": [
    [50.40164, 24.23933],
    [50.40168, 24.23917],
    [50.40129, 24.23889],
    [50.40141, 24.23843],
    [50.40116, 24.23824],
    [50.40096, 24.23795],
    [50.40089, 24.2376],
    [50.39894, 24.23632],
    [50.39883, 24.23634],
    [50.39778, 24.23566],
    [50.39766, 24.23573],
    [50.39743, 24.2356],
    [50.39572, 24.23449],
    [50.39508, 24.23409],
    [50.39386, 24.23336],
    [50.3914, 24.23386],
    [50.39012, 24.23417],
    [50.38948, 24.23657],
  ],
  "pamyatnyk_hrushevskomu-povorot_na_bendiuhu": [
    [50.38948, 24.23657],
    [50.38473, 24.23336],
    [50.38387, 24.23319],
    [50.38303, 24.23314],
    [50.38262, 24.23304],
    [50.38199, 24.23273],
  ],
  "povorot_na_bendiuhu-zastava": [
    [50.38199, 24.23273],
    [50.3815, 24.23247],
    [50.37657, 24.22919],
    [50.37633, 24.22891],
    [50.37612, 24.22848],
    [50.37431, 24.22513],
    [50.37403, 24.22466],
    [50.37364, 24.22425],
    [50.36999, 24.2217],
    [50.36578, 24.21971],
  ],
  "zastava-povorot_na_4_shahtu": [
    [50.36578, 24.21971],
    [50.3418, 24.2092],
    [50.34135, 24.20891],
    [50.3396, 24.2078],
    [50.3368, 24.2058],
    [50.3349, 24.2045],
    [50.33255, 24.20334],
  ],
  "povorot_na_4_shahtu-dacha_na_6_shahti": [
    [50.33255, 24.20334],
    [50.33245, 24.20303],
    [50.33239, 24.20276],
    [50.33439, 24.19281],
    [50.33458, 24.19237],
    [50.3404, 24.1846],
    [50.3458, 24.17735],
    [50.34606, 24.17711],
    [50.34654, 24.17702],
    [50.34726, 24.17712],
    [50.34883, 24.17749],
    [50.3508, 24.17807],
    [50.35125, 24.17787],
    [50.35169, 24.17753],
    [50.35177, 24.17721],
    [50.3514, 24.17505],
    [50.34988, 24.16706],
    [50.34965, 24.16556],
    [50.34958, 24.16366],
    [50.34966, 24.16249],
    [50.3502, 24.15846],
    [50.35033, 24.15758],
    [50.35042, 24.15635],
    [50.35044, 24.15547],
    [50.35036, 24.14969],
    [50.35027, 24.14917],
    [50.35008, 24.14895],
    [50.34992, 24.14893],
    [50.3497, 24.14902],
    [50.34923, 24.14937],
    [50.34814, 24.15012],
    [50.34782, 24.15022],
    [50.34492, 24.15019],
    [50.34006, 24.1502],
    [50.33933, 24.14971],
    [50.33896, 24.14932],
    [50.33768, 24.14682],
    [50.33749, 24.14678],
    [50.3374, 24.1469],
    [50.33707, 24.14821],
    [50.33658, 24.14969],
    [50.33653, 24.15001],
    [50.33664, 24.15019],
    [50.33798, 24.1507],
    [50.3377, 24.1538],
    [50.338, 24.154],
  ],
}

var routes = [
  roads["start_finish-dobriachynskyi_vyyizd"].concat(
    roads["dobriachynskyi_vyyizd-povorot_na_boriatyn"],
    roads["povorot_na_boriatyn-boriatynskyi_vyyizd"],
    roads["boriatynskyi_vyyizd-savchynske_perehrestia"],
    roads["savchynske_perehrestia-povorot_na_savhyn"],
    roads["povorot_na_savhyn-povorot_na_zavyshen"],
    roads["povorot_na_zavyshen-perehrestia_v_zavyshni"],
    roads["stezhka_pid_buhom"],
    roads["vyizd_zi_stezhky_pid_buhom-start_finish"],
  ),
  roads["vyizd_zi_stezhky_pid_buhom-start_finish"].reverse().concat(
    roads["stezhka_pid_buhom"].reverse(),
    roads["perehrestia_v_zavyshni-sokalskyi_mish_livyi_bereh"],
    roads["mist_v_sokali"],
    roads["sokal_bohdana-sokal_ukrauinska"],
    roads["sokal_ukrayinska-sokal_centre"],
    roads["sokal_centre-ilkovychi"],
    roads["ilkovychi-skomorohy"],
    roads["skomorohy-trudoliubivka_zupynka"],
    roads["trudoliubivka_zupynka-perehrestia_v_zabuzhzhi"],
    roads["perehrestia_v_zabuzhzhi-povorot_na_boyanychi"],
    roads["boriatynskyi_vyyizd-savchynske_perehrestia"].reverse(),
    roads["boriatynskyi_vyyizd_nyzhche-boriatyn_povorot_na_rudku"],
    roads["boriatyn_povorot_na_rudku-harazhnyi_kooperatyv_5"],
    roads["harazhnyi_kooperatyv_5-start_finish"]
  ),
  roads["start_finish-pamyatnyk_hrushevskomu"].concat(
    roads["pamyatnyk_hrushevskomu-povorot_na_bendiuhu"],
    roads["povorot_na_bendiuhu-zastava"],
    roads["zastava-povorot_na_4_shahtu"],
    roads["povorot_na_4_shahtu-dacha_na_6_shahti"]
  )
]

var lines = []
routes.forEach(function(route) {
  lines.push(
    L.polyline(route, {color: 'red'})
  )
})

function drawRoute(index) {
  var polyline = lines[index].addTo(map);
  var distance = Number(polyline.getDistance());
  if (index === 2)
    distance *= 2;
  document.getElementById("distance").innerHTML =
    `${Math.floor(distance)} км ${Math.floor(1000 * (distance.toFixed(3) - Math.floor(distance)))} м`;
  // zoom the map to the polyline
  map.fitBounds(polyline.getBounds());
}

function clearRoute(index) {
  map.removeLayer(lines[index]);
}

function getRoutes() {
  for(var i = 0; i < routes.length; i++) {
    const j = i;
    var button = document.createElement("button");
    button.className = "route";
    button.innerHTML = j + 1;
    button.onclick = function() {
      if (this.style.backgroundColor === CLICKED_BUTTON_COLOUR) {
        clearRoute(j)
        this.style.backgroundColor = NOT_CLICKED_BUTTON_COLOUR;
      } else {
        drawRoute(j)
        this.style.backgroundColor = CLICKED_BUTTON_COLOUR;
      }
    };
    button.id = "#" + j
    document.getElementById("routes").appendChild(
      button
    )
  }
}

function toggleParagraph(id) {
  document.getElementById(id).hidden = !document.getElementById(id).hidden;
}

getRoutes();
